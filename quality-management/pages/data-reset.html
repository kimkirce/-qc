<div id="data-reset" class="page-content" style="display:none;">
  <div class="page-header">
    <h2>ğŸ”„ ë°ì´í„° ì´ˆê¸°í™”</h2>
    <p>ì‹œìŠ¤í…œ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•˜ì„¸ìš”!</p>
  </div>

  <div class="content-section">
    <div class="form-container" style="max-width: 800px; margin: 0 auto;">
      <h3>âš ï¸ ì´ˆê¸°í™” ì˜µì…˜</h3>
      
      <div class="alert-box" style="background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); padding: 20px; border-radius: 12px; margin-bottom: 30px;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
          <span style="font-size: 32px;">âš ï¸</span>
          <h4 style="color: var(--danger); margin: 0;">ì£¼ì˜ì‚¬í•­</h4>
        </div>
        <ul style="margin: 10px 0 0 44px; color: var(--text-secondary); line-height: 1.8;">
          <li>ì´ˆê¸°í™”ëœ ë°ì´í„°ëŠ” <strong>ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</strong></li>
          <li>ë°˜ë“œì‹œ <strong>ë°±ì—…</strong>ì„ ë¨¼ì € ìˆ˜í–‰í•˜ì„¸ìš”</li>
          <li>ì „ì²´ ì´ˆê¸°í™”ëŠ” ëª¨ë“  ëª¨ë“ˆì˜ ë°ì´í„°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤</li>
          <li>í—¤ë”(ì—´ ì œëª©)ëŠ” ìœ ì§€ë˜ê³  ë°ì´í„°ë§Œ ì‚­ì œë©ë‹ˆë‹¤</li>
        </ul>
      </div>

      <!-- íŠ¹ì • ì‹œíŠ¸ ì´ˆê¸°í™” -->
      <div style="background: var(--bg-glass); padding: 24px; border-radius: 16px; margin-bottom: 20px;">
        <h4 style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <span>ğŸ“„</span>
          íŠ¹ì • ì‹œíŠ¸ ì´ˆê¸°í™”
        </h4>
        <div class="form-grid">
          <div class="form-group">
            <label>ëª¨ë“ˆ ì„ íƒ</label>
            <select id="reset-module" style="padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); width: 100%;">
              <option value="">ì„ íƒí•˜ì„¸ìš”</option>
              <option value="TP-101">TP-101 - ê³µê¸‰ì‚¬í‰ê°€</option>
              <option value="TP-201">TP-201 - ë³€ê²½ì ê´€ë¦¬</option>
              <option value="TP-301">TP-301 - ì„±ì ì„œë°œí–‰</option>
              <option value="TP-401">TP-401 - ë„ë©´ê´€ë¦¬</option>
              <option value="TP-501">TP-501 - í˜„ì¥ê´€ë¦¬</option>
              <option value="TP-601">TP-601 - ê³ ê°ë¶ˆë§Œ</option>
              <option value="TP-701">TP-701 - ê³µì •ê²€ì‚¬</option>
              <option value="TP-801">TP-801 - ì´ìƒë™ì‘ê²€ì¶œ</option>
              <option value="TP-901">TP-901 - ì‘ì—…í‘œì¤€ì„œ</option>
              <option value="TP-1001">TP-1001 - ì¡°ë¦½SOP</option>
              <option value="TP-1101">TP-1101 - ê²€ì‚¬ê¸°ì¤€</option>
            </select>
          </div>
          <div class="form-group">
            <label>ì‹œíŠ¸ëª… ì…ë ¥</label>
            <input type="text" id="reset-sheet" placeholder="ì˜ˆ: TP-101-02_ê³µê¸‰ì‚¬í‰ê°€í‘œ" style="padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); width: 100%;">
          </div>
        </div>
        <button onclick="resetSheet()" style="width: 100%; padding: 14px; background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; margin-top: 16px;">
          ì‹œíŠ¸ ì´ˆê¸°í™”
        </button>
      </div>

      <!-- ëª¨ë“ˆ ì „ì²´ ì´ˆê¸°í™” -->
      <div style="background: var(--bg-glass); padding: 24px; border-radius: 16px; margin-bottom: 20px;">
        <h4 style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <span>ğŸ“¦</span>
          ëª¨ë“ˆ ì „ì²´ ì´ˆê¸°í™”
        </h4>
        <div class="form-group">
          <label>ëª¨ë“ˆ ì„ íƒ</label>
          <select id="reset-module-all" style="padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); width: 100%;">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="TP-101">TP-101 - ê³µê¸‰ì‚¬í‰ê°€ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-201">TP-201 - ë³€ê²½ì ê´€ë¦¬ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-301">TP-301 - ì„±ì ì„œë°œí–‰ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-401">TP-401 - ë„ë©´ê´€ë¦¬ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-501">TP-501 - í˜„ì¥ê´€ë¦¬ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-601">TP-601 - ê³ ê°ë¶ˆë§Œ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-701">TP-701 - ê³µì •ê²€ì‚¬ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-801">TP-801 - ì´ìƒë™ì‘ê²€ì¶œ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-901">TP-901 - ì‘ì—…í‘œì¤€ì„œ (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-1001">TP-1001 - ì¡°ë¦½SOP (ëª¨ë“  ì‹œíŠ¸)</option>
            <option value="TP-1101">TP-1101 - ê²€ì‚¬ê¸°ì¤€ (ëª¨ë“  ì‹œíŠ¸)</option>
          </select>
        </div>
        <button onclick="resetModule()" style="width: 100%; padding: 14px; background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; margin-top: 16px;">
          ëª¨ë“ˆ ì´ˆê¸°í™”
        </button>
      </div>

      <!-- ì „ì²´ ì‹œìŠ¤í…œ ì´ˆê¸°í™” -->
      <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%); padding: 24px; border-radius: 16px; border: 2px solid var(--danger);">
        <h4 style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px; color: var(--danger);">
          <span>ğŸš¨</span>
          ì „ì²´ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        </h4>
        <p style="color: var(--text-secondary); margin-bottom: 16px;">
          ëª¨ë“  ëª¨ë“ˆì˜ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ì •ë§ ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•˜ì„¸ìš”!
        </p>
        <div class="form-group">
          <label>í™•ì¸ ë¬¸êµ¬ ì…ë ¥ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„)</label>
          <input type="text" id="reset-confirm" placeholder="ì „ì²´ì‚­ì œ" style="padding: 12px; background: var(--bg-secondary); border: 1px solid var(--danger); border-radius: 8px; color: var(--text-primary); width: 100%;">
        </div>
        <button onclick="resetAll()" style="width: 100%; padding: 14px; background: linear-gradient(135deg, var(--danger) 0%, #7f1d1d 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; margin-top: 16px;">
          âš ï¸ ì „ì²´ ì´ˆê¸°í™” ì‹¤í–‰
        </button>
      </div>

      <!-- ì´ˆê¸°í™” ì´ë ¥ -->
      <div style="margin-top: 30px;">
        <h4 style="margin-bottom: 16px;">ğŸ“œ ìµœê·¼ ì´ˆê¸°í™” ì´ë ¥</h4>
        <div id="reset-history" style="background: var(--bg-glass); padding: 20px; border-radius: 12px; min-height: 100px;">
          <p style="color: var(--text-tertiary); text-align: center;">ì´ˆê¸°í™” ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜ë“¤
function showResetMenu() {
  showPage('data-reset');
}

async function resetSheet() {
  const moduleCode = document.getElementById('reset-module').value;
  const sheetName = document.getElementById('reset-sheet').value;
  
  if (!moduleCode || !sheetName) {
    showNotification('ëª¨ë“ˆê³¼ ì‹œíŠ¸ëª…ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”', 'warning');
    return;
  }
  
  if (!confirm(`${moduleCode} ëª¨ë“ˆì˜ "${sheetName}" ì‹œíŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`)) {
    return;
  }
  
  showNotification('ì´ˆê¸°í™” ì¤‘...', 'info');
  
  try {
    const result = await google.script.run
      .withSuccessHandler(onResetSuccess)
      .withFailureHandler(onResetFailure)
      .clearSheetData(moduleCode, sheetName);
  } catch (error) {
    onResetFailure(error);
  }
}

async function resetModule() {
  const moduleCode = document.getElementById('reset-module-all').value;
  
  if (!moduleCode) {
    showNotification('ëª¨ë“ˆì„ ì„ íƒí•˜ì„¸ìš”', 'warning');
    return;
  }
  
  if (!confirm(`${moduleCode} ëª¨ë“ˆì˜ ëª¨ë“  ì‹œíŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`)) {
    return;
  }
  
  showNotification('ì´ˆê¸°í™” ì¤‘...', 'info');
  
  try {
    const result = await google.script.run
      .withSuccessHandler(onResetSuccess)
      .withFailureHandler(onResetFailure)
      .clearModuleData(moduleCode);
  } catch (error) {
    onResetFailure(error);
  }
}

async function resetAll() {
  const confirmText = document.getElementById('reset-confirm').value;
  
  if (confirmText !== 'ì „ì²´ì‚­ì œ') {
    showNotification('í™•ì¸ ë¬¸êµ¬ë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”', 'danger');
    return;
  }
  
  if (!confirm('âš ï¸ ê²½ê³ !\n\nì „ì²´ ì‹œìŠ¤í…œì˜ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!\n\nì •ë§ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    return;
  }
  
  if (!confirm('ë§ˆì§€ë§‰ í™•ì¸ì…ë‹ˆë‹¤.\n\nì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    return;
  }
  
  showNotification('ì „ì²´ ì´ˆê¸°í™” ì¤‘... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)', 'info');
  
  try {
    const result = await google.script.run
      .withSuccessHandler(onResetSuccess)
      .withFailureHandler(onResetFailure)
      .clearAllData();
  } catch (error) {
    onResetFailure(error);
  }
}

function onResetSuccess(result) {
  if (result.success) {
    showNotification(result.message || 'ì´ˆê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
    
    // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
    document.getElementById('reset-module').value = '';
    document.getElementById('reset-sheet').value = '';
    document.getElementById('reset-module-all').value = '';
    document.getElementById('reset-confirm').value = '';
    
    // ì´ë ¥ ì¶”ê°€
    addResetHistory(result.message);
    
    // ëŒ€ì‹œë³´ë“œ í†µê³„ ìƒˆë¡œê³ ì¹¨
    loadDashboardStats();
  } else {
    showNotification(result.message || 'ì´ˆê¸°í™” ì‹¤íŒ¨', 'danger');
  }
}

function onResetFailure(error) {
  console.error('ì´ˆê¸°í™” ì—ëŸ¬:', error);
  showNotification('ì´ˆê¸°í™” ì‹¤íŒ¨: ' + error.message, 'danger');
}

function addResetHistory(message) {
  const historyDiv = document.getElementById('reset-history');
  const now = new Date().toLocaleString('ko-KR');
  
  const historyItem = document.createElement('div');
  historyItem.style.cssText = 'padding: 12px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;';
  historyItem.innerHTML = `
    <span style="color: var(--text-secondary);">${message}</span>
    <span style="color: var(--text-tertiary); font-size: 12px;">${now}</span>
  `;
  
  if (historyDiv.querySelector('p')) {
    historyDiv.innerHTML = '';
  }
  
  historyDiv.insertBefore(historyItem, historyDiv.firstChild);
  
  // ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ë³´ê´€
  while (historyDiv.children.length > 5) {
    historyDiv.removeChild(historyDiv.lastChild);
  }
}
</script>
