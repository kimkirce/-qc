<div id="tp101-02" class="page-content">

        <div class="page-header">
          <h2>📊 공급사 평가표 (TP-101-02)</h2>
          <p>공급사를 체계적으로 평가하고 관리합니다</p>
        </div>

        <div class="action-bar">
          <button class="btn btn-primary" onclick="newEvaluation()">➕ 신규추가</button>
          <button class="btn btn-success" onclick="saveEvaluation()">💾 저장</button>
          <button class="btn btn-secondary">📋 복사</button>
          <button class="btn btn-secondary" onclick="loadEvaluations()">🔄 새로고침</button>
          <button class="btn btn-secondary" onclick="printEvaluation()">📄 PDF 출력</button>
          <button class="btn btn-secondary" onclick="printEvaluation()">🖨️ 프린터 출력</button>
        </div>

        <!-- 평가 입력 폼 -->
        <div class="form-container" id="evaluationForm">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h3>공급사 평가표 TP-101-02</h3>
            <div style="display: flex; gap: 12px; font-size: 12px; color: var(--text-tertiary);">
              <div style="text-align: center; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
                <div>담당</div>
                <div style="height: 30px; margin-top: 4px;"></div>
              </div>
              <div style="text-align: center; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
                <div>부서장</div>
                <div style="height: 30px; margin-top: 4px;"></div>
              </div>
              <div style="text-align: center; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
                <div>사장</div>
                <div style="height: 30px; margin-top: 4px;"></div>
              </div>
            </div>
          </div>

          <!-- 기본 정보 -->
          <div class="form-grid" style="margin-bottom: 24px;">
            <div class="form-group">
              <label>업체명 *</label>
              <select id="companyName" onchange="loadCompanyInfo()" style="padding: 12px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); width: 100%; cursor: pointer;">
                <option value="">업체를 선택하세요</option>
              </select>
              <div style="margin-top: 8px; font-size: 12px; color: var(--text-tertiary);">
                * 업체가 목록에 없다면 <a href="#" onclick="showPage('company-register'); return false;" style="color: var(--primary-light); text-decoration: underline;">설정 &gt; 업체 등록</a>에서 추가하세요
              </div>
            </div>
            <div class="form-group">
              <label>사업자번호</label>
              <input type="text" id="businessNo" placeholder="000-00-00000">
            </div>
            <div class="form-group">
              <label>대표자</label>
              <input type="text" id="ceo" placeholder="대표자명">
            </div>
            <div class="form-group">
              <label>설립년월일</label>
              <input type="date" id="establishDate">
            </div>
            <div class="form-group" style="grid-column: 1 / -1;">
              <label>소재지</label>
              <input type="text" id="address" placeholder="주소를 입력하세요">
            </div>
          </div>

          <!-- 평가방법 -->
          <div style="margin-bottom: 24px; padding: 16px; background: var(--bg-secondary); border-radius: 12px;">
            <label style="font-size: 13px; font-weight: 600; color: var(--text-secondary); margin-bottom: 12px; display: block;">평가방법</label>
            <div style="display: flex; gap: 24px;">
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="radio" name="evalMethod" value="방문" checked> 업체방문
              </label>
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="radio" name="evalMethod" value="서류"> 서류검토
              </label>
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="radio" name="evalMethod" value="기타"> 기타
              </label>
              <input type="text" id="evalMethodEtc" placeholder="기타 입력" style="padding: 8px 12px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); flex: 1;">
            </div>
          </div>

          <!-- 평가 항목 테이블 -->
          <div style="margin-bottom: 24px;">
            <h4 style="font-size: 16px; font-weight: 700; margin-bottom: 16px; color: var(--text-primary);">평가 항목</h4>
            
            <div style="background: var(--bg-secondary); border-radius: 12px; overflow: hidden; border: 1px solid var(--border);">
              <!-- 업체경력 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); font-weight: 600; display: flex; align-items: center; border-right: 1px solid var(--border);">업체능력</div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);">업체 경력</div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="career" value="5" onchange="calculateTotal()"> 1년 미만 (5점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="career" value="10" onchange="calculateTotal()"> 3년 미만 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="career" value="15" onchange="calculateTotal()"> 3년 이상 (15점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="careerScore">0</div>
              </div>

              <!-- 인력보유 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); border-right: 1px solid var(--border);"></div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);">인력보유현황(기사포함)</div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="manpower" value="5" onchange="calculateTotal()"> 1명 이상 (5점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="manpower" value="10" onchange="calculateTotal()"> 3명 이상 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="manpower" value="15" onchange="calculateTotal()"> 5명 이상 (15점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="manpowerScore">0</div>
              </div>

              <!-- 재무구조 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); border-right: 1px solid var(--border);"></div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);">재무구조,경영능력</div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="finance" value="5" onchange="calculateTotal()"> 미흡 (5점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="finance" value="10" onchange="calculateTotal()"> 보통 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="finance" value="15" onchange="calculateTotal()"> 우수 (15점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="financeScore">0</div>
              </div>

              <!-- 단가적정성 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); font-weight: 600; display: flex; align-items: center; border-right: 1px solid var(--border);">가격 및 품질</div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);">단가적정성(타사대비)</div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="price" value="15" onchange="calculateTotal()"> 낮음 (15점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="price" value="10" onchange="calculateTotal()"> 동등 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="price" value="5" onchange="calculateTotal()"> 높음 (5점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="priceScore">0</div>
              </div>

              <!-- 품질 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); border-right: 1px solid var(--border);"></div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);">품질(타사대비)</div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="quality" value="5" onchange="calculateTotal()"> 평균 (5점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="quality" value="10" onchange="calculateTotal()"> 유사 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="quality" value="15" onchange="calculateTotal()"> 우수 (15점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="qualityScore">0</div>
              </div>

              <!-- 평가자평가 -->
              <div style="display: grid; grid-template-columns: 120px 200px 1fr 80px; border-bottom: 1px solid var(--border);">
                <div style="padding: 16px; background: var(--bg-tertiary); font-weight: 600; display: flex; align-items: center; border-right: 1px solid var(--border);">평가자의 평가</div>
                <div style="padding: 16px; background: var(--bg-glass); border-right: 1px solid var(--border);"></div>
                <div style="padding: 16px; display: flex; gap: 12px; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="evaluator" value="5" onchange="calculateTotal()"> 하 (5점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="evaluator" value="10" onchange="calculateTotal()"> 중 (10점)
                  </label>
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="evaluator" value="15" onchange="calculateTotal()"> 상 (15점)
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--primary-light); border-left: 1px solid var(--border);" id="evaluatorScore">0</div>
              </div>

              <!-- ISO 가산점 -->
              <div style="display: grid; grid-template-columns: 320px 1fr 80px; border-bottom: 1px solid var(--border); background: var(--bg-glass);">
                <div style="padding: 16px; border-right: 1px solid var(--border);">해당분야 ISO 9000 인증업체인 경우 10점 가산</div>
                <div style="padding: 16px; display: flex; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" id="isoBonus" onchange="calculateTotal()"> ISO 9000 인증 보유
                  </label>
                </div>
                <div style="padding: 16px; text-align: center; font-weight: 700; color: var(--success); border-left: 1px solid var(--border);" id="isoScore">0</div>
              </div>

              <!-- 합계 -->
              <div style="display: grid; grid-template-columns: 320px 1fr 80px; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);">
                <div style="padding: 20px; font-weight: 700; font-size: 16px; color: white;">합 계</div>
                <div style="padding: 20px;"></div>
                <div style="padding: 20px; text-align: center;">
                  <div style="font-weight: 800; font-size: 24px; color: white;" id="totalScore">0</div>
                  <div style="font-size: 10px; color: rgba(255,255,255,0.8); margin-top: 6px; line-height: 1.4;">
                    <div>80점 이상: <strong>선정 ✅</strong></div>
                    <div>50-70점: <strong>재심사 ⚠️</strong></div>
                    <div>0-40점: <strong>미선정 ❌</strong></div>
                  </div>
                </div>
              </div>
            </div>

            <div style="margin-top: 16px; padding: 16px; background: var(--bg-glass); border-radius: 12px; border: 1px solid var(--border);">
              <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.6;">
                <strong style="color: var(--primary-light);">업체 선정 기준:</strong><br>
                • <span style="color: var(--success);">80점 이상</span>: 선정 ✅<br>
                • <span style="color: var(--warning);">50-70점</span>: 재심사 필요 ⚠️<br>
                • <span style="color: var(--danger);">0-40점</span>: 미선정 ❌
              </p>
            </div>
          </div>

          <!-- 종합의견 -->
          <div class="form-group" style="margin-bottom: 24px;">
            <label>평가자 종합의견</label>
            <textarea id="evaluatorOpinion" placeholder="종합적인 의견을 입력하세요" style="min-height: 150px;"></textarea>
          </div>

          <!-- 평가자 정보 -->
          <div class="form-grid" style="grid-template-columns: 1fr 1fr auto;">
            <div class="form-group">
              <label>평가일자</label>
              <input type="date" id="evalDate">
            </div>
            <div class="form-group">
              <label>평가자</label>
              <input type="text" id="evaluatorName" placeholder="평가자명">
            </div>
            <div class="form-group" style="display: flex; align-items: flex-end; padding-bottom: 2px;">
              <button class="btn btn-success" onclick="saveEvaluation()" style="padding: 14px 20px; font-size: 14px; white-space: nowrap;">
                💾 저장
              </button>
            </div>
          </div>
        </div>

        <!-- 평가 이력 -->
        <div class="data-container" style="margin-top: 32px;">
          <h3 style="padding: 24px; font-size: 18px; font-weight: 700; border-bottom: 1px solid var(--border);">평가 이력</h3>
          <div class="table-wrapper">
            <table class="data-table">
              <thead>
                <tr>
                  <th>No</th>
                  <th>업체명</th>
                  <th>평가일자</th>
                  <th>평가자</th>
                  <th>총점</th>
                  <th>선정여부</th>
                  <th>작업</th>
                </tr>
              </thead>
              <tbody id="evaluationList">
                <tr>
                  <td colspan="7" style="text-align: center; padding: 20px;">로딩 중...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- TP-101-03 시정예방조치 -->
      </div>
